#include "encoding.h"
#include <iostream>

Encoding *Encoding::instance = new Encoding();
Encoding::SymbolsPair Encoding::symbolsPair[] = {
    {0x80, 0xC0}, {0x81, 0xC1}, {0x82, 0xC2}, {0x83, 0xC3}, {0x84, 0xC4}, {0x85, 0xC5}, {0x86, 0xC6}, {0x87, 0xC7},//
    {0x88, 0xC8}, {0x89, 0xC9}, {0x8A, 0xCA}, {0x8B, 0xCB}, {0x8C, 0xCC}, {0x8D, 0xCD}, {0x8E, 0xCE}, {0x8F, 0xCF},//
    {0x90, 0xD0}, {0x91, 0xD1}, {0x92, 0xD2}, {0x93, 0xD3}, {0x94, 0xD4}, {0x95, 0xD5}, {0x96, 0xD6}, {0x97, 0xD7},// Big cyrillic letters
    {0x98, 0xD8}, {0x99, 0xD9}, {0x9A, 0xDA}, {0x9B, 0xDB}, {0x9C, 0xDC}, {0x9D, 0xDD}, {0x9E, 0xDE}, {0x9F, 0xDF},//
    {0xF0, 0xA8},                                                                                                  //
    {0xA0, 0xE0}, {0xA1, 0xE1}, {0xA2, 0xE2}, {0xA3, 0xE3}, {0xA4, 0xE4}, {0xA5, 0xE5}, {0xA6, 0xE6}, {0xA7, 0xE7},//
    {0xA8, 0xE8}, {0xA9, 0xE9}, {0xAA, 0xEA}, {0xAB, 0xEB}, {0xAC, 0xEC}, {0xAD, 0xED}, {0xAE, 0xEE}, {0xAF, 0xEF},//
    {0xE0, 0xF0}, {0xE1, 0xF1}, {0xE2, 0xF2}, {0xE3, 0xF3}, {0xE4, 0xF4}, {0xE5, 0xF5}, {0xE6, 0xF6}, {0xE7, 0xF7},// Small cyrillic letters
    {0xE8, 0xF8}, {0xE9, 0xF9}, {0xEA, 0xFA}, {0xEB, 0xFB}, {0xEC, 0xFC}, {0xED, 0xFD}, {0xEE, 0xFE}, {0xEF, 0xFF},//
    {0xF1, 0xB8},                                                                                                  //
};


char Encoding::convertChar (char c, bool from866)
{
    int len = sizeof (symbolsPair) / sizeof (SymbolsPair);

    if((unsigned char)c < 128) {
        return c;
    }

    for (int i = 0; i < len; i++) {
        if (symbolsPair[i].from == (unsigned char)c && from866) {
            return (char) symbolsPair[i].to;
        } else if (symbolsPair[i].to == (unsigned char)c && !from866) {
            return (char) symbolsPair[i].from;
        }
    }

    return from866 ? 0xA0 : 0xFF;
}


Encoding::Encoding ()
{

}
